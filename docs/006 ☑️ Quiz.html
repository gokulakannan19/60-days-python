<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quiz</title>

    <style>
      body {
        font-family: sf pro text, -apple-system, BlinkMacSystemFont, Roboto,
          segoe ui, Helvetica, Arial, sans-serif, apple color emoji,
          segoe ui emoji, segoe ui symbol;
        font-weight: 400;
        line-height: 22.4px;
        font-size: 16px;
      }
      p,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      ul,
      ol {
        font-size: 16px;
        font-weight: 400;
      }
      ul {
        list-style: none;
        margin: 0;
        padding: 0;
        max-width: none;
      }
      code {
        background-color: #fff;
        border: 1px solid #d1d7dc;
        color: #b4690e;
        font-size: 90%;
        padding: 0.2rem 0.4rem;
      }
      .quiz-content {
        padding: 2.4rem;
        word-break: break-word;
        max-width: 86rem;
        margin: 0 auto;
      }
      .quiz-container {
        margin: 0 auto;
        max-width: 84rem;
        padding: 0;
      }
      .question {
        margin-bottom: 5rem;
      }
      .question span {
        font-size: 24px;
        font-weight: 700;
      }
      .question-prompt {
        margin-top: 0.8rem;
        font-weight: 700;
      }
      .question-answer {
        margin-top: 1.6rem;
        padding-left: 0;
        box-sizing: border-box;
      }
      .question-answer label {
        max-width: 80rem;
        position: relative;
        cursor: pointer;
        display: flex;
        min-width: 18rem;
        border: solid #1c1d1f 2px;
      }
      .question-answer div {
        display: flex;
        align-items: center;
        padding: 0.5rem;
        width: 100%;
      }
      .question-answer div:hover {
        background-color: #f5f5f5;
      }
      .question-answer input {
        display: none;
      }
      .question-answer span {
        width: 1rem;
        height: 1rem;
        margin-right: 1.6rem;
        top: 0;
        border-radius: 50%;
        display: inline-block;
        flex-shrink: 0;
        border: 0.2rem solid #1c1d1f;
        position: relative;
      }
      .selected {
        background: #1c1d1f;
        box-shadow: 0 0 0 0.4rem #fff inset;
      }
      .score {
              position: fixed;
            }
    </style>
  </head>

  <body onload="main()">
    <div id="score" class="score">
      <span>Score: N/A of N/A</span>
    </div>
    <div id="quiz-container" class="quiz-content"></div>

    <script>
      const quizData = {"pass_percent": 70, "questions": [{"_class": "assessment", "id": 47373460, "assessment_type": "multiple-choice", "prompt": {"question": "<p>When can try-except be used?</p>", "relatedLectureIds": "", "feedbacks": ["We generally use match-case to match a pattern.", "We generally use if-elif-else to evaluate a condition.", "Yes, we can use try-except to anticipate an error."], "answers": ["<p>When matching a pattern.</p>", "<p>When evaluating a condition.</p>", "<p>When catching an error.</p>"]}, "correct_response": ["c"], "section": "", "question_plain": "When can try-except be used?", "related_lectures": []}, {"_class": "assessment", "id": 47373486, "assessment_type": "multiple-choice", "prompt": {"question": "<p>Select the <strong>wrong</strong> statement.</p>", "relatedLectureIds": "", "feedbacks": ["This is a correct statement. One can use try-except to divert the program from producing an error message and make it do something else instead.", "This is a correct statement. If the code under try has an error, the interpreter carries on executing the code under except.", "This is a correct statement. As an example, if you write \"except:\" instead of \"except IndexError\" the program will not only catch index errors but every other type of error in case there is one.", "This is the wrong statement among the four. Therefore, this is the correct answer. If there is no error under try, the code under except is never executed."], "answers": ["<p>Try-except can be used to not let the program produce an error message.</p>", "<p>The code under <code>except</code> is only executed when the code under <code>try</code> has an error.</p>", "<p>If the type of the error is not specified (as in <code>except IndexError:</code>, <code>except ValueError:</code>, etc), other error types will also be captured.</p>", "<p>The code under <code>except</code> is executed even when there is <strong>no</strong> error in the code under <code>try</code>.</p>"]}, "correct_response": ["d"], "section": "", "question_plain": "Select the wrong statement.", "related_lectures": []}, {"_class": "assessment", "id": 47373658, "assessment_type": "multiple-choice", "prompt": {"question": "<p>Adding a number to a string produces a <code>TypeError</code> in Python. With that in mind, what do you think the code below will print out?</p><pre class=\"prettyprint linenums\">try:\n    \"a\" + 2\nexcept TypeError:\n    print(\"Cannot add number to string.\")</pre>", "relatedLectureIds": "", "feedbacks": ["There is an TypeError in line 2 because a number cannot be added to a string. Therefore, the code under except will be executed since except is catching a TypeError here.", "We will not get this because the error will be caught by try-except and the code under except will be executed printing out the string \"Cannot add number to string\"."], "answers": ["<pre class=\"prettyprint linenums\">Cannot add number to string.</pre>", "<pre class=\"prettyprint linenums\">Traceback (most recent call last):\n  File \"/Users/as/Dropbox/pm1_course/PM1 2023/app1_by_day/delete.py\", line 2, in &lt;module&gt;\n    \"a\" + 2\nTypeError: can only concatenate str (not \"int\") to str</pre>"]}, "correct_response": ["a"], "section": "", "question_plain": "Adding a number to a string produces a TypeError in Python. With that in mind, what do you think the code below will print out?try:\n    \"a\" + 2\nexcept TypeError:\n    print(\"Cannot add number to string.\")", "related_lectures": []}, {"_class": "assessment", "id": 47373802, "assessment_type": "multiple-choice", "prompt": {"question": "<p>What will the following code produce this time?</p><pre class=\"prettyprint linenums\">try:\n    \"a\" + 2\nexcept IndexError:\n    print(\"Cannot add number to string.\")</pre>", "relatedLectureIds": "", "feedbacks": ["The code in line 2 produces a TypeError but \"except\" is only catching index errors. Therefore, the TypeError will not be caught here.", "This is true because \"except\" will not capture the TypeError produced by line 2 since \"except\" only captures an IndexError in this code."], "answers": ["<p><code>Cannot add number to string.</code> </p>", "<p><code>Traceback (most recent call last): File \"/tmp/sessions/c43e203c30a16482/main.py\", line 2, in &lt;module&gt; \"a\" + 2 TypeError: can only concatenate str (not \"int\") to str</code> </p>"]}, "correct_response": ["b"], "section": "", "question_plain": "What will the following code produce this time?try:\n    \"a\" + 2\nexcept IndexError:\n    print(\"Cannot add number to string.\")", "related_lectures": []}]};
      var correct = 0;
      var total = 0;
      const questionData = quizData.questions
      const passPercent = quizData.pass_percent

      function main() {
        total = questionData.length;

        var questions = [];
        for (var i = 0; i < questionData.length; i++) {
          var question = questionData[i];
          var questionText = question.prompt.question;
          var answers = question.prompt.answers;
          var correctAnswer = question.correct_response[0];
          var correctAnswerText = answers[correctAnswer.charCodeAt(0) - 97];
          var questionObj = {
            question: questionText,
            correctAnswer: correctAnswerText,
            answers: answers,
            id: question.id,
          };
          questions.push(questionObj);
        }

        updateScore();

        // display the questions
        var questionsContainer = document.getElementById("quiz-container");
        for (var i = 0; i < questions.length; i++) {
          var question = questions[i];
          var questionElement = document.createElement("form");
          questionElement.className = "question";
          questionElement.innerHTML =
            "<span>Question " +
            (i + 1) +
            ":</span>" +
            '<div class="question-prompt">' +
            question.question +
            "</div>";
          questionElement.id = question.id;
          questionElement.classList.add("quiz-container");
          var answersElement = document.createElement("ul");
          answersElement.className = "answers";
          for (var j = 0; j < question.answers.length; j++) {
            var answer = question.answers[j];
            var answerElement = document.createElement("li");
            answerElement.className = "answer";
            answerElement.innerHTML =
              '<label for="input-' +
              question.id +
              "-" +
              j +
              '"><div onclick="select(' +
              question.id +
              ", " +
              j +
              ')"><span></span><input id="input-' +
              question.id +
              "-" +
              j +
              '" type="radio" name="question' +
              i +
              '" value="' +
              j +
              '">' +
              answer +
              "</input></div></label>";
            answerElement.classList.add("question-answer");
            answersElement.appendChild(answerElement);
          }

          questionElement.appendChild(answersElement);

          // add a submit button
          var submitButton = document.createElement("button");
          submitButton.className = "submit";
          submitButton.innerHTML = "Submit";
          submitButton.classList.add("submit-button");

          submitButton.addEventListener("click", function (e) {
            e.preventDefault();
            var questionElement = e.target.parentElement;
            var questionId = questionElement.id;
            var question = questions.filter(function (q) {
              return q.id == questionId;
            })[0];

            // set the border color of all answers to black
            var answers = questionElement.getElementsByClassName("answer");
            for (var i = 0; i < answers.length; i++) {
              console.log(answers[i]);
              answers[i].children[0].style.borderColor = "#1c1d1f";
            }

            var answer = questionElement.querySelector(
              'input[type="radio"]:checked'
            );
            if (answer) {
              var answerIndex = answer.value;
              var answerText = question.answers[answerIndex];
              if (answerText == question.correctAnswer) {
                answer.parentElement.parentElement.style.borderColor =
                  "limegreen";
                // alert("Correct!");
                correct++;
                updateScore();
              } else {
                answer.parentElement.parentElement.style.borderColor = "red";
                // alert("Incorrect!");
              }
            } else {
              alert("Please select an answer.");
            }
          });

          // add button
          questionElement.appendChild(submitButton);

          questionsContainer.appendChild(questionElement);
        }
      }

      function select(question, answer) {
        var questionElement = document.getElementById(question);
        var answers = questionElement.getElementsByClassName("answer");
        for (var i = 0; i < answers.length; i++) {
          var span = answers[i].children[0].children[0].children[0];
          var input = answers[i].children[0].children[0].children[1];
          span.classList.remove("selected");
          input.checked = false;
        }
        var span = answers[answer].children[0].children[0].children[0];
        var input = answers[answer].children[0].children[0].children[1];
        span.classList.add("selected");
        input.checked = true;
      }

      function updateScore() {
        var scoreElem = document.getElementById("score");
        const score = (correct / total) * 100;
        scoreElem.innerHTML = "Score: " + score + "/" + passPercent + "%";
      }
    </script>
  </body>
</html>
